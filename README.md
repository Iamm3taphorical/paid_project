# Freelance Pro - Project Management System

## Project Overview

Freelance Pro is a comprehensive project management dashboard designed for freelancers to manage their clients, jobs, payments, and business analytics. It is built as a modern web application using Next.js and connects to a Supabase (PostgreSQL) database for real-time data persistence.

The system allows users to track their workload, monitor financial health, and analyze client reliability through a suite of advanced analytics features.

## Technology Stack

*   **Framework:** Next.js 14 (App Router)
*   **Language:** TypeScript
*   **Styling:** Tailwind CSS
*   **Database:** Supabase (PostgreSQL)
*   **Icons:** Lucide React
*   **Authentication & Data:** Custom API routes interacting with Supabase

---

## Codebase Structure & Functionality

This section explains the purpose and functionality of each major part of the codebase.

### 1. Database Connection (`src/lib/db.ts`)

This file is the backbone of the application's data layer. It initializes the connection to Supabase using the project URL and Anonymous Key stored in environment variables.

*   **supabase**: An exported client instance used throughout the application to fetch, insert, update, and delete data from the PostgreSQL database.
*   **testConnection**: A utility function that runs a simple query to verify if the application can successfully communicate with the database.

### 2. Backend API Routes (`src/app/api/...`)

The application uses Next.js API Routes to handle server-side logic and database interactions. These routes return JSON responses to the frontend.

#### Analytics Endpoints
These endpoints power the charts and metrics on the Dashboard and Analytics pages.

*   `api/analytics/payment-alerts`: identifying payments that are overdue or due within the next 7 days.
*   `api/analytics/monthly-income`: Aggregates all "paid" payments by month and year to show financial growth over time.
*   `api/analytics/client-reliability`: Calculates a reliability score (0-100%) for each client based on their history of on-time versus overdue payments.
*   `api/analytics/completion-time`: Measures the average number of days between a job's start date and its final payment date to estimate project turnaround time.
*   `api/analytics/service-demand`: Counts how many jobs require specific services (e.g., Web Development vs. UI Design) to identify market trends.
*   `api/analytics/service-revenue`: Sums up the total income generated by each service category.
*   `api/analytics/high-value-projects`: Identifies projects with a total value significantly higher than the average project value.
*   `api/analytics/review-sentiment`: Analyzes client review text for positive or negative keywords to gauge customer satisfaction.
*   `api/analytics/workload-status`: Provides a summary count of ongoing projects, completed projects, and pending invoices.

#### Core Management Endpoints
These endpoints handle the CRUD (Create, Read, Update, Delete) operations for the main entities.

*   `api/clients`: Fetches the list of clients or adds a new client. Supports updating and deleting specific clients via ID parameters.
*   `api/jobs`: Manages project listings. It links jobs to specific clients and services. It also handles status updates (e.g., marking a job as "Completed").
*   `api/payments`: Tracks invoices. It allows creating new payment records and updating their status (e.g., from "Pending" to "Paid").
*   `api/profile`: Manages the freelancer's personal information, hourly rate, and security settings. It includes logic to auto-create a default profile if one does not exist.

### 3. Frontend Application (`src/app/dashboard/...`)

The frontend is built with React components and uses a responsive layout with a sidebar for navigation.

#### Dashboard (`dashboard/page.tsx`)
The landing page after login. It provides a high-level overview of the business.
*   **State Management**: Uses React `useState` and `useEffect` to fetch data from multiple API endpoints in parallel.
*   **Empty State Handling**: If the database is new/empty, it gracefully shows zeros instead of broken charts.
*   **Key Metrics**: Displays Total Revenue, Pending Payments, and Active Jobs at a glance.

#### Analytics (`dashboard/analytics/page.tsx`)
A dedicated page for deep dives into business performance.
*   **Feature Toggles**: Includes a settings panel that allows users to show or hide specific metrics based on what matters to them.
*   **Live Data**: All charts reflect real-time data from the SQL database.

#### Clients (`dashboard/clients/page.tsx`)
A directory of all customers.
*   **Reliability Badges**: Visual indicators (Green/Yellow/Red) derived from the Client Reliability API to warn about potential late payers.
*   **Modal Forms**: Uses a popup modal for adding or editing client details without leaving the page.

#### Jobs (`dashboard/jobs/page.tsx`)
The project management center.
*   **Filtering**: Allows filtering the list by status (Ongoing, Completed, Cancelled).
*   **High-Value Highlighting**: Automatically flags jobs that are worth more than the average, helping freelancers prioritize big clients.

#### Payments (`dashboard/payments/page.tsx`)
The financial tracker.
*   **Status Tracking**: Shows which invoices are Paid vs Pending.
*   **Alerts**: Prominently displays overdue bills at the top of the page.
*   **Actions**: Provides a one-click button to mark a pending invoice as "Paid".

#### Profile (`dashboard/profile/page.tsx`)
Settings for the user account.
*   **Data Persistence**: Saves display preferences (like the user's name in the sidebar) to LocalStorage for immediate UI updates, while also syncing critical data to the database.

---

## Database Schema

The data is organized into several relational tables in PostgreSQL:

*   **User**: Stores login credentials and basic info for both Freelancers and Customers.
*   **ServiceProvider**: Extends the User table with specific freelancer details like Hourly Rate.
*   **Customer**: Extends the User table with client-specific info like Address and Phone.
*   **Job**: Represents a project with a Title, Status, and Total Amount.
*   **Payment**: Records specific invoices linked to Jobs.
*   **Service**: Defines the types of work offered (e.g., Web Development).
*   **Review**: Stores client feedback and ratings.

---

## How to Run

1.  **Install Dependencies**:
    Run `npm install` to download the required packages.

2.  **Environment Setup**:
    Ensure the `.env.local` file contains your Supabase URL and Anon Key.

3.  **Start Development Server**:
    Run `npm run dev` to start the application on `http://localhost:3000`.

4.  **Database Reset (Optional)**:
    If you wish to clear all data and start fresh, you can run the provided SQL cleanup script in your Supabase SQL editor.
